# EBusiness
电商用户行为分析大数据平台

一、用户访问session分析
	1.按条件筛选session
		让使用者，对感兴趣的和关系的用户群体，进行后续各种复杂业务逻辑的统计和分析
			1).sparkSQL筛选  >>>
	2.统计出符合条件的session中时长和步长的占比
        从全局的角度看到，符合某些条件的用户群体，使用我们的产品的一些习惯。比如大多数人，到底是会在产品中停留多长时间，大多数人，会在一次使用产品的过程中，访问多少个页面。那么对于使用者来说，有一个全局和清晰的认识
			1).按sessionId聚合，session数据和user_info进行jion，得到完整session聚合数据
			2).计算session时长、步长
			3).遍历RDD，再过滤筛选数据
			4).自定义累加器，累加所有访问步长、时长的值，计算占比
	3.在符合条件的session中，按照时间比例随机抽取session
		对于符合条件的session，按照时间比例均匀的随机采样出1000个session，然后观察每个session具体的点击流/行为
		随机抽取算法实现，观察样本的公平性
			1).每天的每个小时的session数量
			2).计算占比,计算每个小时抽取的session个数
			3).随机索引生成，抽取session
	4.在符合条件的session中，获取点击、下单和支付数量排名前10的品类
		得到符合条件的用户，他最感兴趣的商品是什么种类。这个可以让公司里的人，清晰地了解到不同层次、不同类型的用户的心理和喜好
			1).计算出session访问过的所有品类的点击、下单和支付次数
			2).自定义key，二次排序
	5.对于排名前10的品类，分别获取其点击次数排名前10的session
		对某个用户群体最感兴趣的品类(Top10商品)，各个品类最感兴趣最典型的用户的session的行为
			1).session粒度聚合，获取到session对每个品类的点击次数
			2).productId分组，取前十

二、页面单跳转化率
	产品经理，可以根据这个指标，去尝试分析，整个网站，产品，各个页面的表现怎么样，是不是需要去优化产品的布局；吸引用户最终可以进入最后的支付页面；
	数据分析师，可以基于咱们的这个数据，做更深一步的计算和分析
	企业管理层，可以看到整个公司的网站，各个页面的之间的跳转的表现，如何？心里有数，可以适当调整公司的经营战略或策略
		1.计算出各个在指定页面流中的页面切片的访问量，算法实现
		2.计算出符合页面流的各个切片的pv（访问量）
		3.针对用户指定的页面流，去计算各个页面单跳切片的转化率
		
三、各区域热门商品统计
	哪些商品在哪个地区卖得最好
		1.SparkSQL  UDF、UDAF、开窗函数
		
四、广告点击流量实时统计
	让产品经理、高管可以实时地掌握到公司打的各种广告的投放效果。以便于后期持续地对公司的广告投放相关的战略和策略，进行调整和优化；以期望获得最好的广告收益
		1.实时计算各batch中的每天各用户对各广告的点击次数，写入MySQL中
		2.使用filter过滤出每天对某个广告点击超过100次的黑名单用户，并写入MySQL中
		3.使用transform操作，对每个batch RDD进行处理，都动态加载MySQL中的黑名单生成RDD，然后进行join后，过滤掉batch RDD中的黑名单用户的广告点击行为	4.使用updateStateByKey操作，实时计算每天各省各城市各广告的点击量，并时候更新到MySQL
		5.使用transform结合Spark SQL，统计每天各省份top3热门广告：
			首先以每天各省各城市各广告的点击量数据作为基础，统计出每天各省份各广告的点击量；
			然后启动一个异步子线程，使用SparkSQL动态将数据RDD转换为DataFrame后，注册为临时表；
			最后使用Spark SQL开窗函数，统计出各省份top3热门的广告，并更新到MySQL中
		6.使用window操作，对最近1小时滑动窗口内的数据，计算出各广告各分钟的点击量，并更新到MySQL中
